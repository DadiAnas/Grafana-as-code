# Grafana Datasources Configuration - PROD Environment
# These override or extend shared datasources for PROD
# Set use_vault: true to fetch credentials from HashiCorp Vault

datasources:
  # Main Organization Datasources (default org)
  - name: "Prometheus"
    type: "prometheus"
    uid: "prometheus"
    url: "http://prometheus-prod.example.com:9090"
    org: "Main Organization"
    is_default: true
    access_mode: "proxy"
    basic_auth_enabled: false
    json_data:
      httpMethod: "POST"
      timeInterval: "15s"

  - name: "Loki"
    type: "loki"
    uid: "loki"
    url: "http://loki-prod.example.com:3100"
    org: "Main Organization"
    is_default: false
    access_mode: "proxy"
    json_data:
      maxLines: 1000

  - name: "InfluxDB"
    type: "influxdb"
    uid: "influxdb"
    url: "http://influxdb-prod.example.com:8086"
    org: "Main Organization"
    is_default: false
    access_mode: "proxy"
    use_vault: true
    json_data:
      version: "Flux"
      organization: "my-org"
      defaultBucket: "my-bucket"

  - name: "PostgreSQL"
    type: "postgres"
    uid: "postgres"
    url: "postgres-prod.example.com:5432"
    org: "Main Organization"
    is_default: false
    use_vault: true
    json_data:
      database: "grafana_prod"
      sslmode: "require"
      maxOpenConns: 50
      maxIdleConns: 50
      connMaxLifetime: 14400

  - name: "Elasticsearch"
    type: "elasticsearch"
    uid: "elasticsearch"
    url: "http://elasticsearch-prod.example.com:9200"
    org: "Main Organization"
    is_default: false
    access_mode: "proxy"
    json_data:
      esVersion: "8.0.0"
      timeField: "@timestamp"
      logMessageField: "message"
      logLevelField: "level"

  - name: "Tempo"
    type: "tempo"
    uid: "tempo"
    url: "http://tempo-prod.example.com:3200"
    org: "Main Organization"
    is_default: false
    access_mode: "proxy"
    json_data:
      tracesToLogsV2:
        datasourceUid: "loki"
        spanStartTimeShift: "-1h"
        spanEndTimeShift: "1h"
        filterByTraceID: true
        filterBySpanID: true
      tracesToMetrics:
        datasourceUid: "prometheus"
        spanStartTimeShift: "-1h"
        spanEndTimeShift: "1h"
      serviceMap:
        datasourceUid: "prometheus"
      nodeGraph:
        enabled: true

  # PROD-specific: Debug datasource (only in PROD)
  - name: "Debug-Prometheus"
    type: "prometheus"
    uid: "debug-prometheus"
    url: "http://prometheus-debug-prod.example.com:9090"
    org: "Platform Team"
    is_default: false
    access_mode: "proxy"
    json_data:
      httpMethod: "POST"
      timeInterval: "5s"

